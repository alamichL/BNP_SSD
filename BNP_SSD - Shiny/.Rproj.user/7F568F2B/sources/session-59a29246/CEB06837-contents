# rm(list=ls())
#setwd("~/Documents/GitHub/BNPconsistency/scripts_for_figures")
## read sources
source("~/Documents/Louise/PY_hyperprior_consistency-main/Code_SP_Mix/Random_SpMix.R")
source("~/Documents/Louise/PY_hyperprior_consistency-main/scripts2/Estimation_SPMix_2.R")
source("~/Documents/Louise/PY_hyperprior_consistency-main/Code_SP_Mix/Identification_SpMix.R")
source("~/Documents/Louise/PY_hyperprior_consistency-main/scripts2/Gibbs_sampling_function_par.R")

require(tidyr)
require(e1071)
require(mclust)
require(MASS)
require(bayesm)
require(MCMCpack)
require(mvtnorm)
require(Runuran)
require(flexclust)
library(gridExtra)
library(cowplot)
library(ggplot2)


ds_list <- c("~/Documents/Louise/PY_hyperprior_consistency-main/sim_data/Data_50.RData", "~/Documents/Louise/PY_hyperprior_consistency-main/sim_data/Data_200.RData",
             "~/Documents/Louise/PY_hyperprior_consistency-main/sim_data/Data_500.RData", "~/Documents/Louise/PY_hyperprior_consistency-main/sim_data/Data_2000.RData")


###### Prior Unif ###### 
alpha_grid <- c(0.01, 0.1, 1, 10)

for(al in alpha_grid){
  df_3 <- comparison_prior(ds_list, n_chains=4, M_it=2000, nburn=20000, alpha=al, priorOns0=T, typePrior="unif")
  save(df_3, file=paste0("~/Documents/Louise/PY_hyperprior_consistency-main/saves_for_figures/cmp_fig3_alpha_",al,"_unif.RData"))
}

###### Prior Beta ######
param_a <- c(2,   0.1, 2,  0.5, 2, 1)
param_b <- c(198, 0.9, 18, 0.5, 2, 0.25)

for(al in alpha_grid){
  for(i in 1:length(param_a)){
    a_b = param_a[i]; b_b = param_b[i]
    df_3 <- comparison_prior(ds_list, n_chains=4, M_it=2000, nburn=40000, alpha=al, 
                             priorOns0=T, typePrior="beta", a_beta=a_b, b_beta=b_b)
    save(df_3, file=
           paste0("~/Documents/Louise/PY_hyperprior_consistency-main/saves_for_figures/cmp_fig3_alpha_",al,"_beta_",a_b,"_",b_b,".RData"))
  }
}

# alpha=5
# df_unif<-comparison_prior(ds_list, M_it= 2000 , nburn = 500, priorOnalpha=F, alpha=alpha, priorOns0=T, typePrior="unif")
# save(df_unif, file = paste0("~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_",alpha,"fig3_unif.RData"))
# 
# 
# df_unif<-comparison_prior(ds_list,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=0, priorOns0=T, typePrior="unif")
# save(df_unif, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_fig3_unif.RData")
# 
# df_beta<-comparison_prior(ds_list,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=0, priorOns0=T, typePrior="beta", a_beta=0.5, b_beta=2)
# save(df_beta, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_fig3_beta_0.5_2.RData")
# 
# df_beta<-comparison_prior(ds_list,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=0, priorOns0=T, typePrior="beta", a_beta=0.5, b_beta=0.5)
# save(df_beta, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_fig3_beta_0.5_0.5.RData")
# 
# 
# 
# #---------- B) Specification of the simulation and prior parameters -----------------------------------------------
# 
# ds_list<- c("~/Documents/Projet_Caroline/simulation/sim_data/Data_50.RData", "~/Documents/Projet_Caroline/simulation/sim_data/Data_200.RData",
#             "~/Documents/Projet_Caroline/simulation/sim_data/Data_500.RData", "~/Documents/Projet_Caroline/simulation/sim_data/Data_2000.RData")
# 
# 
# df_unif<-comparison_prior(ds_list,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=10, priorOns0=T, typePrior="unif")
# save(df_unif, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_fig3_unif.RData")
# 
# df_beta<-comparison_prior(ds_list,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=10, priorOns0=T, typePrior="beta", a_beta=0.5, b_beta=2)
# save(df_beta, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_fig3_beta_0.5_2.RData")
# 
# df_beta<-comparison_prior(ds_list,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=10, priorOns0=T, typePrior="beta", a_beta=0.5, b_beta=0.5)
# save(df_beta, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_fig3_beta_0.5_0.5.RData")
# 
# ## Second type of data
# ds_list1 <- c("~/Documents/Projet_Caroline/simulation/sim_data/Data_50_comp_1.RData", "~/Documents/Projet_Caroline/simulation/sim_data/Data_200_comp_1.RData",
#               "~/Documents/Projet_Caroline/simulation/sim_data/Data_500_comp_1.RData", "~/Documents/Projet_Caroline/simulation/sim_data/Data_2000_comp_1.RData")
# 
# df_beta<-comparison_prior(ds_list1,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=10, priorOns0=T, typePrior="beta", a_beta=0.5, b_beta=0.5)
# save(df_beta, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_comp_1_fig3_beta_0.5_0.5.RData")
# 
# df_unif<-comparison_prior(ds_list1,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=10, priorOns0=T, typePrior="unif")
# save(df_unif, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_comp_1_fig3_unif.RData")
# 
# df_beta<-comparison_prior(ds_list1,K_ = 10, M_it= 20000 , nburn = 5000, priorOnalpha=F, alpha=10, priorOns0=T, typePrior="beta", a_beta=0.5, b_beta=2)
# save(df_beta, file = "~/Documents/Projet_Caroline/simulation/saves_for_figures/cmp_comp_1_fig3_beta_0.5_2.RData")
